@app.route('/eliminar_cuenta', methods=['POST'])
def eliminar_cuenta():
    if 'usuario_id' not in session:
        return redirect(url_for('login'))

    usuario_id = session['usuario_id']
    conn = sqlite3.connect('instance/ClaveForte.db')
    cur = conn.cursor()
    cur.execute("DELETE FROM Credentials WHERE id_usr = ?", (usuario_id,))
    cur.execute("DELETE FROM Users WHERE id_usr = ?", (usuario_id,))
    conn.commit()
    conn.close()

    session.clear()
    flash("Cuenta eliminada correctamente.")
    return redirect(url_for('signup'))
{% extends 'layout.html' %}

{% block content %}

<h2>Mi Perfil</h2>

<form method="POST" action="{{ url_for('perfil') }}">
    <label>Nombre:</label><br>
    <input type="text" name="nombre" value="{{ usuario['usr_name'] }}" required><br><br>

    <label>Correo:</label><br>
    <input type="email" name="correo" value="{{ usuario['usr_mail'] }}" required><br><br>

    <label>Nueva Contraseña:</label><br>
    <input type="password" name="password"><br><br>

    <button type="submit">Guardar Cambios</button>
</form>

<hr>

<form method="POST" action="{{ url_for('eliminar_cuenta') }}" onsubmit="return confirm('¿Deseas eliminar tu cuenta? Esta acción no se puede deshacer.')">
    <button type="submit" style="color:red;">Eliminar Cuenta</button>
</form>
{% endblock %}
